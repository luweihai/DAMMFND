lr: 0.0001; model name: dammfnd; emb_type: bert; batchsize: 64; epoch: 50; gpu: 0; emb_dim: 768
Loading vision model config from /root/miniconda3/lib/python3.10/site-packages/cn_clip/clip/model_configs/ViT-B-16.json
Loading text model config from /root/miniconda3/lib/python3.10/site-packages/cn_clip/clip/model_configs/RoBERTa-wwm-ext-base-chinese.json
Model info {'embed_dim': 512, 'image_resolution': 224, 'vision_layers': 12, 'vision_width': 768, 'vision_patch_size': 16, 'vocab_size': 21128, 'text_attention_probs_dropout_prob': 0.1, 'text_hidden_act': 'gelu', 'text_hidden_dropout_prob': 0.1, 'text_hidden_size': 768, 'text_initializer_range': 0.02, 'text_intermediate_size': 3072, 'text_max_position_embeddings': 512, 'text_num_attention_heads': 12, 'text_num_hidden_layers': 12, 'text_type_vocab_size': 2}
Loading vision model config from /root/miniconda3/lib/python3.10/site-packages/cn_clip/clip/model_configs/ViT-B-16.json
Loading text model config from /root/miniconda3/lib/python3.10/site-packages/cn_clip/clip/model_configs/RoBERTa-wwm-ext-base-chinese.json
Model info {'embed_dim': 512, 'image_resolution': 224, 'vision_layers': 12, 'vision_width': 768, 'vision_patch_size': 16, 'vocab_size': 21128, 'text_attention_probs_dropout_prob': 0.1, 'text_hidden_act': 'gelu', 'text_hidden_dropout_prob': 0.1, 'text_hidden_size': 768, 'text_initializer_range': 0.02, 'text_intermediate_size': 3072, 'text_max_position_embeddings': 512, 'text_num_attention_heads': 12, 'text_num_hidden_layers': 12, 'text_type_vocab_size': 2}
Loading vision model config from /root/miniconda3/lib/python3.10/site-packages/cn_clip/clip/model_configs/ViT-B-16.json
Loading text model config from /root/miniconda3/lib/python3.10/site-packages/cn_clip/clip/model_configs/RoBERTa-wwm-ext-base-chinese.json
Model info {'embed_dim': 512, 'image_resolution': 224, 'vision_layers': 12, 'vision_width': 768, 'vision_patch_size': 16, 'vocab_size': 21128, 'text_attention_probs_dropout_prob': 0.1, 'text_hidden_act': 'gelu', 'text_hidden_dropout_prob': 0.1, 'text_hidden_size': 768, 'text_initializer_range': 0.02, 'text_intermediate_size': 3072, 'text_max_position_embeddings': 512, 'text_num_attention_heads': 12, 'text_num_hidden_layers': 12, 'text_type_vocab_size': 2}
/root/miniconda3/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Loading vision model config from /root/miniconda3/lib/python3.10/site-packages/cn_clip/clip/model_configs/ViT-B-16.json
Loading text model config from /root/miniconda3/lib/python3.10/site-packages/cn_clip/clip/model_configs/RoBERTa-wwm-ext-base-chinese.json
Model info {'embed_dim': 512, 'image_resolution': 224, 'vision_layers': 12, 'vision_width': 768, 'vision_patch_size': 16, 'vocab_size': 21128, 'text_attention_probs_dropout_prob': 0.1, 'text_hidden_act': 'gelu', 'text_hidden_dropout_prob': 0.1, 'text_hidden_size': 768, 'text_initializer_range': 0.02, 'text_intermediate_size': 3072, 'text_max_position_embeddings': 512, 'text_num_attention_heads': 12, 'text_num_hidden_layers': 12, 'text_type_vocab_size': 2}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:29<00:00,  2.65it/s]
Training Epoch 1; Loss 1.1161622683723256; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.68it/s]
curent {'科技': {'precision': 0.8712, 'recall': 0.8712, 'fscore': 0.8712, 'acc': 0.8824}, '军事': {'precision': 0.8333, 'recall': 0.8667, 'fscore': 0.8231, 'acc': 0.8261}, '教育考试': {'precision': 0.7767, 'recall': 0.682, 'fscore': 0.6869, 'acc': 0.7419}, '灾难事故': {'precision': 0.9119, 'recall': 0.9293, 'fscore': 0.9199, 'acc': 0.9318}, '政治': {'precision': 0.8889, 'recall': 0.9333, 'fscore': 0.9018, 'acc': 0.9091}, '医药健康': {'precision': 0.9061, 'recall': 0.9052, 'fscore': 0.9047, 'acc': 0.9048}, '财经商业': {'precision': 0.9228, 'recall': 0.8657, 'fscore': 0.8876, 'acc': 0.9103}, '文体娱乐': {'precision': 0.96, 'recall': 0.925, 'fscore': 0.9386, 'acc': 0.945}, '社会生活': {'precision': 0.8743, 'recall': 0.8736, 'fscore': 0.8739, 'acc': 0.875}, 'auc': 0.9708619777895294, 'metric': 0.893984920531786, 'recall': 0.8939185616076151, 'precision': 0.8980697704245223, 'acc': 0.8943089430894309, 'real': {'precision': 0.9347826086956522, 'recall': 0.8459016393442623, 'F1': 0.8881239242685026}, 'fake': {'precision': 0.8613569321533924, 'recall': 0.9419354838709677, 'F1': 0.8998459167950693}}
Max {'科技': {'precision': 0.8712, 'recall': 0.8712, 'fscore': 0.8712, 'acc': 0.8824}, '军事': {'precision': 0.8333, 'recall': 0.8667, 'fscore': 0.8231, 'acc': 0.8261}, '教育考试': {'precision': 0.7767, 'recall': 0.682, 'fscore': 0.6869, 'acc': 0.7419}, '灾难事故': {'precision': 0.9119, 'recall': 0.9293, 'fscore': 0.9199, 'acc': 0.9318}, '政治': {'precision': 0.8889, 'recall': 0.9333, 'fscore': 0.9018, 'acc': 0.9091}, '医药健康': {'precision': 0.9061, 'recall': 0.9052, 'fscore': 0.9047, 'acc': 0.9048}, '财经商业': {'precision': 0.9228, 'recall': 0.8657, 'fscore': 0.8876, 'acc': 0.9103}, '文体娱乐': {'precision': 0.96, 'recall': 0.925, 'fscore': 0.9386, 'acc': 0.945}, '社会生活': {'precision': 0.8743, 'recall': 0.8736, 'fscore': 0.8739, 'acc': 0.875}, 'auc': 0.9708619777895294, 'metric': 0.893984920531786, 'recall': 0.8939185616076151, 'precision': 0.8980697704245223, 'acc': 0.8943089430894309, 'real': {'precision': 0.9347826086956522, 'recall': 0.8459016393442623, 'F1': 0.8881239242685026}, 'fake': {'precision': 0.8613569321533924, 'recall': 0.9419354838709677, 'F1': 0.8998459167950693}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:27<00:00,  2.80it/s]
Training Epoch 2; Loss 0.5405310659439533; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.80it/s]
curent {'科技': {'precision': 0.8712, 'recall': 0.8712, 'fscore': 0.8712, 'acc': 0.8824}, '军事': {'precision': 0.9, 'recall': 0.9333, 'fscore': 0.9087, 'acc': 0.913}, '教育考试': {'precision': 0.8288, 'recall': 0.7654, 'fscore': 0.7786, 'acc': 0.8065}, '灾难事故': {'precision': 0.9844, 'recall': 0.9615, 'fscore': 0.9721, 'acc': 0.9773}, '政治': {'precision': 0.9651, 'recall': 0.9651, 'fscore': 0.9651, 'acc': 0.9697}, '医药健康': {'precision': 0.912, 'recall': 0.9037, 'fscore': 0.9042, 'acc': 0.9048}, '财经商业': {'precision': 0.9097, 'recall': 0.9097, 'fscore': 0.9097, 'acc': 0.9231}, '文体娱乐': {'precision': 0.9455, 'recall': 0.9355, 'fscore': 0.9401, 'acc': 0.945}, '社会生活': {'precision': 0.8862, 'recall': 0.8836, 'fscore': 0.8846, 'acc': 0.8859}, 'auc': 0.9774193548387097, 'metric': 0.9154415653093602, 'recall': 0.9154415653093602, 'precision': 0.9154415653093602, 'acc': 0.9154471544715447, 'real': {'precision': 0.9147540983606557, 'recall': 0.9147540983606557, 'F1': 0.9147540983606557}, 'fake': {'precision': 0.9161290322580645, 'recall': 0.9161290322580645, 'F1': 0.9161290322580645}}
Max {'科技': {'precision': 0.8712, 'recall': 0.8712, 'fscore': 0.8712, 'acc': 0.8824}, '军事': {'precision': 0.9, 'recall': 0.9333, 'fscore': 0.9087, 'acc': 0.913}, '教育考试': {'precision': 0.8288, 'recall': 0.7654, 'fscore': 0.7786, 'acc': 0.8065}, '灾难事故': {'precision': 0.9844, 'recall': 0.9615, 'fscore': 0.9721, 'acc': 0.9773}, '政治': {'precision': 0.9651, 'recall': 0.9651, 'fscore': 0.9651, 'acc': 0.9697}, '医药健康': {'precision': 0.912, 'recall': 0.9037, 'fscore': 0.9042, 'acc': 0.9048}, '财经商业': {'precision': 0.9097, 'recall': 0.9097, 'fscore': 0.9097, 'acc': 0.9231}, '文体娱乐': {'precision': 0.9455, 'recall': 0.9355, 'fscore': 0.9401, 'acc': 0.945}, '社会生活': {'precision': 0.8862, 'recall': 0.8836, 'fscore': 0.8846, 'acc': 0.8859}, 'auc': 0.9774193548387097, 'metric': 0.9154415653093602, 'recall': 0.9154415653093602, 'precision': 0.9154415653093602, 'acc': 0.9154471544715447, 'real': {'precision': 0.9147540983606557, 'recall': 0.9147540983606557, 'F1': 0.9147540983606557}, 'fake': {'precision': 0.9161290322580645, 'recall': 0.9161290322580645, 'F1': 0.9161290322580645}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:27<00:00,  2.80it/s]
Training Epoch 3; Loss 0.329471267275996; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.63it/s]
curent {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 0.9688, 'recall': 0.9375, 'fscore': 0.9505, 'acc': 0.9565}, '教育考试': {'precision': 0.9045, 'recall': 0.8904, 'fscore': 0.8963, 'acc': 0.9032}, '灾难事故': {'precision': 0.9559, 'recall': 0.8846, 'fscore': 0.9117, 'acc': 0.9318}, '政治': {'precision': 0.9891, 'recall': 0.9762, 'fscore': 0.9823, 'acc': 0.9848}, '医药健康': {'precision': 0.9103, 'recall': 0.8871, 'fscore': 0.8871, 'acc': 0.8889}, '财经商业': {'precision': 0.8863, 'recall': 0.9236, 'fscore': 0.9, 'acc': 0.9103}, '文体娱乐': {'precision': 0.9355, 'recall': 0.9513, 'fscore': 0.9419, 'acc': 0.945}, '社会生活': {'precision': 0.8966, 'recall': 0.8788, 'fscore': 0.883, 'acc': 0.8859}, 'auc': 0.9839132734003173, 'metric': 0.9185180081826468, 'recall': 0.9191433104177684, 'precision': 0.9235603437219444, 'acc': 0.9186991869918699, 'real': {'precision': 0.8761061946902655, 'recall': 0.9737704918032787, 'F1': 0.9223602484472049}, 'fake': {'precision': 0.9710144927536232, 'recall': 0.864516129032258, 'F1': 0.9146757679180886}}
Max {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 0.9688, 'recall': 0.9375, 'fscore': 0.9505, 'acc': 0.9565}, '教育考试': {'precision': 0.9045, 'recall': 0.8904, 'fscore': 0.8963, 'acc': 0.9032}, '灾难事故': {'precision': 0.9559, 'recall': 0.8846, 'fscore': 0.9117, 'acc': 0.9318}, '政治': {'precision': 0.9891, 'recall': 0.9762, 'fscore': 0.9823, 'acc': 0.9848}, '医药健康': {'precision': 0.9103, 'recall': 0.8871, 'fscore': 0.8871, 'acc': 0.8889}, '财经商业': {'precision': 0.8863, 'recall': 0.9236, 'fscore': 0.9, 'acc': 0.9103}, '文体娱乐': {'precision': 0.9355, 'recall': 0.9513, 'fscore': 0.9419, 'acc': 0.945}, '社会生活': {'precision': 0.8966, 'recall': 0.8788, 'fscore': 0.883, 'acc': 0.8859}, 'auc': 0.9839132734003173, 'metric': 0.9185180081826468, 'recall': 0.9191433104177684, 'precision': 0.9235603437219444, 'acc': 0.9186991869918699, 'real': {'precision': 0.8761061946902655, 'recall': 0.9737704918032787, 'F1': 0.9223602484472049}, 'fake': {'precision': 0.9710144927536232, 'recall': 0.864516129032258, 'F1': 0.9146757679180886}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:27<00:00,  2.83it/s]
Training Epoch 4; Loss 0.28078975557506874; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.65it/s]
curent {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.8958, 'recall': 0.7917, 'fscore': 0.8103, 'acc': 0.8387}, '灾难事故': {'precision': 0.9697, 'recall': 0.9231, 'fscore': 0.9427, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9444, 'recall': 0.9355, 'fscore': 0.9361, 'acc': 0.9365}, '财经商业': {'precision': 0.9292, 'recall': 0.919, 'fscore': 0.9239, 'acc': 0.9359}, '文体娱乐': {'precision': 0.9729, 'recall': 0.9678, 'fscore': 0.9702, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.984632469592808, 'metric': 0.943087023312507, 'recall': 0.9430988894764675, 'precision': 0.943080144679231, 'acc': 0.943089430894309, 'real': {'precision': 0.9411764705882353, 'recall': 0.9442622950819672, 'F1': 0.9427168576104746}, 'fake': {'precision': 0.9449838187702265, 'recall': 0.9419354838709677, 'F1': 0.9434571890145397}}
Max {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.8958, 'recall': 0.7917, 'fscore': 0.8103, 'acc': 0.8387}, '灾难事故': {'precision': 0.9697, 'recall': 0.9231, 'fscore': 0.9427, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9444, 'recall': 0.9355, 'fscore': 0.9361, 'acc': 0.9365}, '财经商业': {'precision': 0.9292, 'recall': 0.919, 'fscore': 0.9239, 'acc': 0.9359}, '文体娱乐': {'precision': 0.9729, 'recall': 0.9678, 'fscore': 0.9702, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.984632469592808, 'metric': 0.943087023312507, 'recall': 0.9430988894764675, 'precision': 0.943080144679231, 'acc': 0.943089430894309, 'real': {'precision': 0.9411764705882353, 'recall': 0.9442622950819672, 'F1': 0.9427168576104746}, 'fake': {'precision': 0.9449838187702265, 'recall': 0.9419354838709677, 'F1': 0.9434571890145397}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:27<00:00,  2.82it/s]
Training Epoch 5; Loss 0.2564815733726923; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.69it/s]
curent {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.9045, 'recall': 0.8904, 'fscore': 0.8963, 'acc': 0.9032}, '灾难事故': {'precision': 0.9697, 'recall': 0.9231, 'fscore': 0.9427, 'acc': 0.9545}, '政治': {'precision': 0.9787, 'recall': 0.9524, 'fscore': 0.9641, 'acc': 0.9697}, '医药健康': {'precision': 0.9444, 'recall': 0.9355, 'fscore': 0.9361, 'acc': 0.9365}, '财经商业': {'precision': 0.9327, 'recall': 0.9514, 'fscore': 0.9411, 'acc': 0.9487}, '文体娱乐': {'precision': 0.9459, 'recall': 0.9585, 'fscore': 0.9514, 'acc': 0.9541}, '社会生活': {'precision': 0.9164, 'recall': 0.9017, 'fscore': 0.9056, 'acc': 0.9076}, 'auc': 0.9857852987837123, 'metric': 0.9381523511104525, 'recall': 0.9385245901639344, 'precision': 0.9406497757561587, 'acc': 0.9382113821138212, 'real': {'precision': 0.9057750759878419, 'recall': 0.9770491803278688, 'F1': 0.9400630914826498}, 'fake': {'precision': 0.9755244755244755, 'recall': 0.9, 'F1': 0.9362416107382551}}
Max {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.8958, 'recall': 0.7917, 'fscore': 0.8103, 'acc': 0.8387}, '灾难事故': {'precision': 0.9697, 'recall': 0.9231, 'fscore': 0.9427, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9444, 'recall': 0.9355, 'fscore': 0.9361, 'acc': 0.9365}, '财经商业': {'precision': 0.9292, 'recall': 0.919, 'fscore': 0.9239, 'acc': 0.9359}, '文体娱乐': {'precision': 0.9729, 'recall': 0.9678, 'fscore': 0.9702, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.984632469592808, 'metric': 0.943087023312507, 'recall': 0.9430988894764675, 'precision': 0.943080144679231, 'acc': 0.943089430894309, 'real': {'precision': 0.9411764705882353, 'recall': 0.9442622950819672, 'F1': 0.9427168576104746}, 'fake': {'precision': 0.9449838187702265, 'recall': 0.9419354838709677, 'F1': 0.9434571890145397}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:27<00:00,  2.80it/s]
Training Epoch 6; Loss 0.2532859431071714; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:04<00:00,  2.44it/s]
curent {'科技': {'precision': 0.9231, 'recall': 0.8333, 'fscore': 0.8583, 'acc': 0.8824}, '军事': {'precision': 0.8636, 'recall': 0.9, 'fscore': 0.8655, 'acc': 0.8696}, '教育考试': {'precision': 0.8393, 'recall': 0.625, 'fscore': 0.6043, 'acc': 0.7097}, '灾难事故': {'precision': 0.8828, 'recall': 0.9132, 'fscore': 0.8952, 'acc': 0.9091}, '政治': {'precision': 0.92, 'recall': 0.9556, 'fscore': 0.9333, 'acc': 0.9394}, '医药健康': {'precision': 0.9379, 'recall': 0.937, 'fscore': 0.9365, 'acc': 0.9365}, '财经商业': {'precision': 0.9319, 'recall': 0.8866, 'fscore': 0.905, 'acc': 0.9231}, '文体娱乐': {'precision': 0.9481, 'recall': 0.9, 'fscore': 0.917, 'acc': 0.9266}, '社会生活': {'precision': 0.8898, 'recall': 0.8881, 'fscore': 0.8804, 'acc': 0.8804}, 'auc': 0.9842305658381809, 'metric': 0.8983134920634921, 'recall': 0.8984928609201481, 'precision': 0.911389295307143, 'acc': 0.8991869918699187, 'real': {'precision': 0.9802371541501976, 'recall': 0.8131147540983606, 'F1': 0.8888888888888888}, 'fake': {'precision': 0.8425414364640884, 'recall': 0.9838709677419355, 'F1': 0.9077380952380952}}
Max {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.8958, 'recall': 0.7917, 'fscore': 0.8103, 'acc': 0.8387}, '灾难事故': {'precision': 0.9697, 'recall': 0.9231, 'fscore': 0.9427, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9444, 'recall': 0.9355, 'fscore': 0.9361, 'acc': 0.9365}, '财经商业': {'precision': 0.9292, 'recall': 0.919, 'fscore': 0.9239, 'acc': 0.9359}, '文体娱乐': {'precision': 0.9729, 'recall': 0.9678, 'fscore': 0.9702, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.984632469592808, 'metric': 0.943087023312507, 'recall': 0.9430988894764675, 'precision': 0.943080144679231, 'acc': 0.943089430894309, 'real': {'precision': 0.9411764705882353, 'recall': 0.9442622950819672, 'F1': 0.9427168576104746}, 'fake': {'precision': 0.9449838187702265, 'recall': 0.9419354838709677, 'F1': 0.9434571890145397}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:27<00:00,  2.80it/s]
Training Epoch 7; Loss 0.2557125070265362; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.61it/s]
curent {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.913, 'recall': 0.8333, 'fscore': 0.8524, 'acc': 0.871}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.953, 'recall': 0.9521, 'fscore': 0.9523, 'acc': 0.9524}, '财经商业': {'precision': 0.9505, 'recall': 0.9282, 'fscore': 0.9383, 'acc': 0.9487}, '文体娱乐': {'precision': 0.9529, 'recall': 0.948, 'fscore': 0.9504, 'acc': 0.9541}, '社会生活': {'precision': 0.9193, 'recall': 0.9164, 'fscore': 0.9176, 'acc': 0.9185}, 'auc': 0.9829402432575357, 'metric': 0.9414508758568164, 'recall': 0.9414066631411951, 'precision': 0.9415747931523373, 'acc': 0.9414634146341463, 'real': {'precision': 0.946843853820598, 'recall': 0.9344262295081968, 'F1': 0.9405940594059407}, 'fake': {'precision': 0.9363057324840764, 'recall': 0.9483870967741935, 'F1': 0.9423076923076924}}
Max {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.8958, 'recall': 0.7917, 'fscore': 0.8103, 'acc': 0.8387}, '灾难事故': {'precision': 0.9697, 'recall': 0.9231, 'fscore': 0.9427, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9444, 'recall': 0.9355, 'fscore': 0.9361, 'acc': 0.9365}, '财经商业': {'precision': 0.9292, 'recall': 0.919, 'fscore': 0.9239, 'acc': 0.9359}, '文体娱乐': {'precision': 0.9729, 'recall': 0.9678, 'fscore': 0.9702, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.984632469592808, 'metric': 0.943087023312507, 'recall': 0.9430988894764675, 'precision': 0.943080144679231, 'acc': 0.943089430894309, 'real': {'precision': 0.9411764705882353, 'recall': 0.9442622950819672, 'F1': 0.9427168576104746}, 'fake': {'precision': 0.9449838187702265, 'recall': 0.9419354838709677, 'F1': 0.9434571890145397}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:27<00:00,  2.79it/s]
Training Epoch 8; Loss 0.24291812057618972; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.74it/s]
curent {'科技': {'precision': 0.9583, 'recall': 0.9167, 'fscore': 0.9328, 'acc': 0.9412}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.8958, 'recall': 0.7917, 'fscore': 0.8103, 'acc': 0.8387}, '灾难事故': {'precision': 0.9119, 'recall': 0.9293, 'fscore': 0.9199, 'acc': 0.9318}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.953, 'recall': 0.9521, 'fscore': 0.9523, 'acc': 0.9524}, '财经商业': {'precision': 0.9505, 'recall': 0.9282, 'fscore': 0.9383, 'acc': 0.9487}, '文体娱乐': {'precision': 0.9729, 'recall': 0.9678, 'fscore': 0.9702, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9880698043363301, 'metric': 0.9446907336479251, 'recall': 0.9446060285563194, 'precision': 0.9450956101899498, 'acc': 0.9447154471544715, 'real': {'precision': 0.9562289562289562, 'recall': 0.9311475409836065, 'F1': 0.9435215946843852}, 'fake': {'precision': 0.9339622641509434, 'recall': 0.9580645161290322, 'F1': 0.9458598726114649}}
Max {'科技': {'precision': 0.9583, 'recall': 0.9167, 'fscore': 0.9328, 'acc': 0.9412}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.8958, 'recall': 0.7917, 'fscore': 0.8103, 'acc': 0.8387}, '灾难事故': {'precision': 0.9119, 'recall': 0.9293, 'fscore': 0.9199, 'acc': 0.9318}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.953, 'recall': 0.9521, 'fscore': 0.9523, 'acc': 0.9524}, '财经商业': {'precision': 0.9505, 'recall': 0.9282, 'fscore': 0.9383, 'acc': 0.9487}, '文体娱乐': {'precision': 0.9729, 'recall': 0.9678, 'fscore': 0.9702, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9880698043363301, 'metric': 0.9446907336479251, 'recall': 0.9446060285563194, 'precision': 0.9450956101899498, 'acc': 0.9447154471544715, 'real': {'precision': 0.9562289562289562, 'recall': 0.9311475409836065, 'F1': 0.9435215946843852}, 'fake': {'precision': 0.9339622641509434, 'recall': 0.9580645161290322, 'F1': 0.9458598726114649}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:27<00:00,  2.77it/s]
Training Epoch 9; Loss 0.2369859079261879; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.79it/s]
curent {'科技': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.913, 'recall': 0.8333, 'fscore': 0.8524, 'acc': 0.871}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.912, 'recall': 0.9037, 'fscore': 0.9042, 'acc': 0.9048}, '财经商业': {'precision': 0.9505, 'recall': 0.9282, 'fscore': 0.9383, 'acc': 0.9487}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9852035959809625, 'metric': 0.9447036049758821, 'recall': 0.9446589106292966, 'precision': 0.9448282794083416, 'acc': 0.9447154471544715, 'real': {'precision': 0.9501661129568106, 'recall': 0.9377049180327869, 'F1': 0.9438943894389439}, 'fake': {'precision': 0.9394904458598726, 'recall': 0.9516129032258065, 'F1': 0.9455128205128205}}
Max {'科技': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.913, 'recall': 0.8333, 'fscore': 0.8524, 'acc': 0.871}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.912, 'recall': 0.9037, 'fscore': 0.9042, 'acc': 0.9048}, '财经商业': {'precision': 0.9505, 'recall': 0.9282, 'fscore': 0.9383, 'acc': 0.9487}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9852035959809625, 'metric': 0.9447036049758821, 'recall': 0.9446589106292966, 'precision': 0.9448282794083416, 'acc': 0.9447154471544715, 'real': {'precision': 0.9501661129568106, 'recall': 0.9377049180327869, 'F1': 0.9438943894389439}, 'fake': {'precision': 0.9394904458598726, 'recall': 0.9516129032258065, 'F1': 0.9455128205128205}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:27<00:00,  2.81it/s]
Training Epoch 10; Loss 0.23550340707425949; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.61it/s]
curent {'科技': {'precision': 0.9583, 'recall': 0.9167, 'fscore': 0.9328, 'acc': 0.9412}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.8958, 'recall': 0.7917, 'fscore': 0.8103, 'acc': 0.8387}, '灾难事故': {'precision': 0.9333, 'recall': 0.9677, 'fscore': 0.9476, 'acc': 0.9545}, '政治': {'precision': 0.9565, 'recall': 0.9778, 'fscore': 0.9659, 'acc': 0.9697}, '医药健康': {'precision': 0.953, 'recall': 0.9521, 'fscore': 0.9523, 'acc': 0.9524}, '财经商业': {'precision': 0.9411, 'recall': 0.9074, 'fscore': 0.9219, 'acc': 0.9359}, '文体娱乐': {'precision': 0.9726, 'recall': 0.95, 'fscore': 0.9596, 'acc': 0.9633}, '社会生活': {'precision': 0.9175, 'recall': 0.9202, 'fscore': 0.9182, 'acc': 0.9185}, 'auc': 0.9879005817028028, 'metric': 0.939729677472328, 'recall': 0.939555790586991, 'precision': 0.9421088464320667, 'acc': 0.9398373983739837, 'real': {'precision': 0.971830985915493, 'recall': 0.9049180327868852, 'F1': 0.937181663837012}, 'fake': {'precision': 0.9123867069486404, 'recall': 0.9741935483870968, 'F1': 0.9422776911076443}}
Max {'科技': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.913, 'recall': 0.8333, 'fscore': 0.8524, 'acc': 0.871}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.912, 'recall': 0.9037, 'fscore': 0.9042, 'acc': 0.9048}, '财经商业': {'precision': 0.9505, 'recall': 0.9282, 'fscore': 0.9383, 'acc': 0.9487}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9852035959809625, 'metric': 0.9447036049758821, 'recall': 0.9446589106292966, 'precision': 0.9448282794083416, 'acc': 0.9447154471544715, 'real': {'precision': 0.9501661129568106, 'recall': 0.9377049180327869, 'F1': 0.9438943894389439}, 'fake': {'precision': 0.9394904458598726, 'recall': 0.9516129032258065, 'F1': 0.9455128205128205}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:27<00:00,  2.80it/s]
Training Epoch 11; Loss 0.2320398488989124; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.62it/s]
curent {'科技': {'precision': 0.9583, 'recall': 0.9167, 'fscore': 0.9328, 'acc': 0.9412}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.8341, 'recall': 0.8224, 'fscore': 0.8272, 'acc': 0.8387}, '灾难事故': {'precision': 0.9844, 'recall': 0.9615, 'fscore': 0.9721, 'acc': 0.9773}, '政治': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '医药健康': {'precision': 0.9444, 'recall': 0.9355, 'fscore': 0.9361, 'acc': 0.9365}, '财经商业': {'precision': 0.9506, 'recall': 0.9606, 'fscore': 0.9554, 'acc': 0.9615}, '文体娱乐': {'precision': 0.9729, 'recall': 0.9678, 'fscore': 0.9702, 'acc': 0.9725}, '社会生活': {'precision': 0.9024, 'recall': 0.8917, 'fscore': 0.8948, 'acc': 0.8967}, 'auc': 0.9852776308831306, 'metric': 0.9414558300896937, 'recall': 0.9416181914331042, 'precision': 0.9420108822221751, 'acc': 0.9414634146341463, 'real': {'precision': 0.9242902208201893, 'recall': 0.9606557377049181, 'F1': 0.942122186495177}, 'fake': {'precision': 0.959731543624161, 'recall': 0.9225806451612903, 'F1': 0.9407894736842105}}
Max {'科技': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.913, 'recall': 0.8333, 'fscore': 0.8524, 'acc': 0.871}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.912, 'recall': 0.9037, 'fscore': 0.9042, 'acc': 0.9048}, '财经商业': {'precision': 0.9505, 'recall': 0.9282, 'fscore': 0.9383, 'acc': 0.9487}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9852035959809625, 'metric': 0.9447036049758821, 'recall': 0.9446589106292966, 'precision': 0.9448282794083416, 'acc': 0.9447154471544715, 'real': {'precision': 0.9501661129568106, 'recall': 0.9377049180327869, 'F1': 0.9438943894389439}, 'fake': {'precision': 0.9394904458598726, 'recall': 0.9516129032258065, 'F1': 0.9455128205128205}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:27<00:00,  2.79it/s]
Training Epoch 12; Loss 0.23079653393912625; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.75it/s]
curent {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.9045, 'recall': 0.8904, 'fscore': 0.8963, 'acc': 0.9032}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '医药健康': {'precision': 0.9444, 'recall': 0.9355, 'fscore': 0.9361, 'acc': 0.9365}, '财经商业': {'precision': 0.9161, 'recall': 0.9421, 'fscore': 0.9272, 'acc': 0.9359}, '文体娱乐': {'precision': 0.9657, 'recall': 0.9553, 'fscore': 0.9601, 'acc': 0.9633}, '社会生活': {'precision': 0.9181, 'recall': 0.9086, 'fscore': 0.9115, 'acc': 0.913}, 'auc': 0.9877736647276573, 'metric': 0.9430797993447235, 'recall': 0.9432575356953993, 'precision': 0.9437456324248776, 'acc': 0.943089430894309, 'real': {'precision': 0.9245283018867925, 'recall': 0.9639344262295082, 'F1': 0.9438202247191011}, 'fake': {'precision': 0.9629629629629629, 'recall': 0.9225806451612903, 'F1': 0.9423393739703458}}
Max {'科技': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.913, 'recall': 0.8333, 'fscore': 0.8524, 'acc': 0.871}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.912, 'recall': 0.9037, 'fscore': 0.9042, 'acc': 0.9048}, '财经商业': {'precision': 0.9505, 'recall': 0.9282, 'fscore': 0.9383, 'acc': 0.9487}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9852035959809625, 'metric': 0.9447036049758821, 'recall': 0.9446589106292966, 'precision': 0.9448282794083416, 'acc': 0.9447154471544715, 'real': {'precision': 0.9501661129568106, 'recall': 0.9377049180327869, 'F1': 0.9438943894389439}, 'fake': {'precision': 0.9394904458598726, 'recall': 0.9516129032258065, 'F1': 0.9455128205128205}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:27<00:00,  2.81it/s]
Training Epoch 13; Loss 0.2282398608210799; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.67it/s]
curent {'科技': {'precision': 0.9583, 'recall': 0.9167, 'fscore': 0.9328, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.913, 'recall': 0.8333, 'fscore': 0.8524, 'acc': 0.871}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.953, 'recall': 0.9521, 'fscore': 0.9523, 'acc': 0.9524}, '财经商业': {'precision': 0.9327, 'recall': 0.9514, 'fscore': 0.9411, 'acc': 0.9487}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9285, 'recall': 0.9293, 'fscore': 0.9289, 'acc': 0.9293}, 'auc': 0.9869804336329984, 'metric': 0.9479442199039296, 'recall': 0.947858276044421, 'precision': 0.9483514389174766, 'acc': 0.9479674796747968, 'real': {'precision': 0.9595959595959596, 'recall': 0.9344262295081968, 'F1': 0.946843853820598}, 'fake': {'precision': 0.9371069182389937, 'recall': 0.9612903225806452, 'F1': 0.9490445859872612}}
Max {'科技': {'precision': 0.9583, 'recall': 0.9167, 'fscore': 0.9328, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.913, 'recall': 0.8333, 'fscore': 0.8524, 'acc': 0.871}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.953, 'recall': 0.9521, 'fscore': 0.9523, 'acc': 0.9524}, '财经商业': {'precision': 0.9327, 'recall': 0.9514, 'fscore': 0.9411, 'acc': 0.9487}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9285, 'recall': 0.9293, 'fscore': 0.9289, 'acc': 0.9293}, 'auc': 0.9869804336329984, 'metric': 0.9479442199039296, 'recall': 0.947858276044421, 'precision': 0.9483514389174766, 'acc': 0.9479674796747968, 'real': {'precision': 0.9595959595959596, 'recall': 0.9344262295081968, 'F1': 0.946843853820598}, 'fake': {'precision': 0.9371069182389937, 'recall': 0.9612903225806452, 'F1': 0.9490445859872612}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:27<00:00,  2.78it/s]
Training Epoch 14; Loss 0.22643040178658128; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.70it/s]
curent {'科技': {'precision': 0.9583, 'recall': 0.9167, 'fscore': 0.9328, 'acc': 0.9412}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.913, 'recall': 0.8333, 'fscore': 0.8524, 'acc': 0.871}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.953, 'recall': 0.9521, 'fscore': 0.9523, 'acc': 0.9524}, '财经商业': {'precision': 0.9506, 'recall': 0.9606, 'fscore': 0.9554, 'acc': 0.9615}, '文体娱乐': {'precision': 0.9726, 'recall': 0.95, 'fscore': 0.9596, 'acc': 0.9633}, '社会生活': {'precision': 0.9229, 'recall': 0.9243, 'fscore': 0.9235, 'acc': 0.9239}, 'auc': 0.9870861977789529, 'metric': 0.9479365079365079, 'recall': 0.9478318350079322, 'precision': 0.9485434322033899, 'acc': 0.9479674796747968, 'real': {'precision': 0.9627118644067797, 'recall': 0.9311475409836065, 'F1': 0.9466666666666668}, 'fake': {'precision': 0.934375, 'recall': 0.964516129032258, 'F1': 0.949206349206349}}
Max {'科技': {'precision': 0.9583, 'recall': 0.9167, 'fscore': 0.9328, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.913, 'recall': 0.8333, 'fscore': 0.8524, 'acc': 0.871}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.953, 'recall': 0.9521, 'fscore': 0.9523, 'acc': 0.9524}, '财经商业': {'precision': 0.9327, 'recall': 0.9514, 'fscore': 0.9411, 'acc': 0.9487}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9285, 'recall': 0.9293, 'fscore': 0.9289, 'acc': 0.9293}, 'auc': 0.9869804336329984, 'metric': 0.9479442199039296, 'recall': 0.947858276044421, 'precision': 0.9483514389174766, 'acc': 0.9479674796747968, 'real': {'precision': 0.9595959595959596, 'recall': 0.9344262295081968, 'F1': 0.946843853820598}, 'fake': {'precision': 0.9371069182389937, 'recall': 0.9612903225806452, 'F1': 0.9490445859872612}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:27<00:00,  2.79it/s]
Training Epoch 15; Loss 0.22481799686883952; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.53it/s]
curent {'科技': {'precision': 0.8712, 'recall': 0.8712, 'fscore': 0.8712, 'acc': 0.8824}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.913, 'recall': 0.8333, 'fscore': 0.8524, 'acc': 0.871}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.953, 'recall': 0.9521, 'fscore': 0.9523, 'acc': 0.9524}, '财经商业': {'precision': 0.9327, 'recall': 0.9514, 'fscore': 0.9411, 'acc': 0.9487}, '文体娱乐': {'precision': 0.9657, 'recall': 0.9553, 'fscore': 0.9601, 'acc': 0.9633}, '社会生活': {'precision': 0.9233, 'recall': 0.9233, 'fscore': 0.9233, 'acc': 0.9239}, 'auc': 0.9869804336329985, 'metric': 0.9430743801652892, 'recall': 0.9430195663670016, 'precision': 0.9432539682539682, 'acc': 0.943089430894309, 'real': {'precision': 0.95, 'recall': 0.9344262295081968, 'F1': 0.9421487603305784}, 'fake': {'precision': 0.9365079365079365, 'recall': 0.9516129032258065, 'F1': 0.944}}
Max {'科技': {'precision': 0.9583, 'recall': 0.9167, 'fscore': 0.9328, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.913, 'recall': 0.8333, 'fscore': 0.8524, 'acc': 0.871}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.953, 'recall': 0.9521, 'fscore': 0.9523, 'acc': 0.9524}, '财经商业': {'precision': 0.9327, 'recall': 0.9514, 'fscore': 0.9411, 'acc': 0.9487}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9285, 'recall': 0.9293, 'fscore': 0.9289, 'acc': 0.9293}, 'auc': 0.9869804336329984, 'metric': 0.9479442199039296, 'recall': 0.947858276044421, 'precision': 0.9483514389174766, 'acc': 0.9479674796747968, 'real': {'precision': 0.9595959595959596, 'recall': 0.9344262295081968, 'F1': 0.946843853820598}, 'fake': {'precision': 0.9371069182389937, 'recall': 0.9612903225806452, 'F1': 0.9490445859872612}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:27<00:00,  2.77it/s]
Training Epoch 16; Loss 0.22408712394051739; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:04<00:00,  2.40it/s]
curent {'科技': {'precision': 0.9583, 'recall': 0.9167, 'fscore': 0.9328, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.913, 'recall': 0.8333, 'fscore': 0.8524, 'acc': 0.871}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.953, 'recall': 0.9521, 'fscore': 0.9523, 'acc': 0.9524}, '财经商业': {'precision': 0.9601, 'recall': 0.9491, 'fscore': 0.9543, 'acc': 0.9615}, '文体娱乐': {'precision': 0.9726, 'recall': 0.95, 'fscore': 0.9596, 'acc': 0.9633}, '社会生活': {'precision': 0.9343, 'recall': 0.9343, 'fscore': 0.9343, 'acc': 0.9348}, 'auc': 0.9885457429931254, 'metric': 0.9495593553968711, 'recall': 0.9494447382337388, 'precision': 0.9502829169050797, 'acc': 0.9495934959349593, 'real': {'precision': 0.9659863945578231, 'recall': 0.9311475409836065, 'F1': 0.9482470784641068}, 'fake': {'precision': 0.9345794392523364, 'recall': 0.967741935483871, 'F1': 0.9508716323296355}}
Max {'科技': {'precision': 0.9583, 'recall': 0.9167, 'fscore': 0.9328, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.913, 'recall': 0.8333, 'fscore': 0.8524, 'acc': 0.871}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.953, 'recall': 0.9521, 'fscore': 0.9523, 'acc': 0.9524}, '财经商业': {'precision': 0.9601, 'recall': 0.9491, 'fscore': 0.9543, 'acc': 0.9615}, '文体娱乐': {'precision': 0.9726, 'recall': 0.95, 'fscore': 0.9596, 'acc': 0.9633}, '社会生活': {'precision': 0.9343, 'recall': 0.9343, 'fscore': 0.9343, 'acc': 0.9348}, 'auc': 0.9885457429931254, 'metric': 0.9495593553968711, 'recall': 0.9494447382337388, 'precision': 0.9502829169050797, 'acc': 0.9495934959349593, 'real': {'precision': 0.9659863945578231, 'recall': 0.9311475409836065, 'F1': 0.9482470784641068}, 'fake': {'precision': 0.9345794392523364, 'recall': 0.967741935483871, 'F1': 0.9508716323296355}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:27<00:00,  2.75it/s]
Training Epoch 17; Loss 0.2231778728884536; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:04<00:00,  2.37it/s]
curent {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.9318, 'recall': 0.875, 'fscore': 0.892, 'acc': 0.9032}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9706, 'recall': 0.9677, 'fscore': 0.9682, 'acc': 0.9683}, '财经商业': {'precision': 0.9506, 'recall': 0.9606, 'fscore': 0.9554, 'acc': 0.9615}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9881332628239027, 'metric': 0.9512131917414115, 'recall': 0.9511898466419884, 'precision': 0.9512566641279512, 'acc': 0.9512195121951219, 'real': {'precision': 0.9537953795379538, 'recall': 0.9475409836065574, 'F1': 0.9506578947368421}, 'fake': {'precision': 0.9487179487179487, 'recall': 0.9548387096774194, 'F1': 0.9517684887459806}}
Max {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.9318, 'recall': 0.875, 'fscore': 0.892, 'acc': 0.9032}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9706, 'recall': 0.9677, 'fscore': 0.9682, 'acc': 0.9683}, '财经商业': {'precision': 0.9506, 'recall': 0.9606, 'fscore': 0.9554, 'acc': 0.9615}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9881332628239027, 'metric': 0.9512131917414115, 'recall': 0.9511898466419884, 'precision': 0.9512566641279512, 'acc': 0.9512195121951219, 'real': {'precision': 0.9537953795379538, 'recall': 0.9475409836065574, 'F1': 0.9506578947368421}, 'fake': {'precision': 0.9487179487179487, 'recall': 0.9548387096774194, 'F1': 0.9517684887459806}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:27<00:00,  2.75it/s]
Training Epoch 18; Loss 0.22277408606046206; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:04<00:00,  2.47it/s]
curent {'科技': {'precision': 0.9583, 'recall': 0.9167, 'fscore': 0.9328, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.9318, 'recall': 0.875, 'fscore': 0.892, 'acc': 0.9032}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9706, 'recall': 0.9677, 'fscore': 0.9682, 'acc': 0.9683}, '财经商业': {'precision': 0.9655, 'recall': 0.9167, 'fscore': 0.9367, 'acc': 0.9487}, '文体娱乐': {'precision': 0.9729, 'recall': 0.9678, 'fscore': 0.9702, 'acc': 0.9725}, '社会生活': {'precision': 0.9182, 'recall': 0.9174, 'fscore': 0.9178, 'acc': 0.9185}, 'auc': 0.988164992067689, 'metric': 0.9479442199039296, 'recall': 0.947858276044421, 'precision': 0.9483514389174766, 'acc': 0.9479674796747968, 'real': {'precision': 0.9595959595959596, 'recall': 0.9344262295081968, 'F1': 0.946843853820598}, 'fake': {'precision': 0.9371069182389937, 'recall': 0.9612903225806452, 'F1': 0.9490445859872612}}
Max {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.9318, 'recall': 0.875, 'fscore': 0.892, 'acc': 0.9032}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9706, 'recall': 0.9677, 'fscore': 0.9682, 'acc': 0.9683}, '财经商业': {'precision': 0.9506, 'recall': 0.9606, 'fscore': 0.9554, 'acc': 0.9615}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9881332628239027, 'metric': 0.9512131917414115, 'recall': 0.9511898466419884, 'precision': 0.9512566641279512, 'acc': 0.9512195121951219, 'real': {'precision': 0.9537953795379538, 'recall': 0.9475409836065574, 'F1': 0.9506578947368421}, 'fake': {'precision': 0.9487179487179487, 'recall': 0.9548387096774194, 'F1': 0.9517684887459806}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:28<00:00,  2.74it/s]
Training Epoch 19; Loss 0.22427460609318375; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:04<00:00,  2.41it/s]
curent {'科技': {'precision': 0.8712, 'recall': 0.8712, 'fscore': 0.8712, 'acc': 0.8824}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.8958, 'recall': 0.7917, 'fscore': 0.8103, 'acc': 0.8387}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9706, 'recall': 0.9677, 'fscore': 0.9682, 'acc': 0.9683}, '财经商业': {'precision': 0.9097, 'recall': 0.9097, 'fscore': 0.9097, 'acc': 0.9231}, '文体娱乐': {'precision': 0.9657, 'recall': 0.9553, 'fscore': 0.9601, 'acc': 0.9633}, '社会生活': {'precision': 0.9395, 'recall': 0.9402, 'fscore': 0.9398, 'acc': 0.9402}, 'auc': 0.9865044949762031, 'metric': 0.9463210264467138, 'recall': 0.9462453728186144, 'precision': 0.9466421781381661, 'acc': 0.9463414634146341, 'real': {'precision': 0.9563758389261745, 'recall': 0.9344262295081968, 'F1': 0.9452736318407959}, 'fake': {'precision': 0.9369085173501577, 'recall': 0.9580645161290322, 'F1': 0.9473684210526315}}
Max {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.9318, 'recall': 0.875, 'fscore': 0.892, 'acc': 0.9032}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9706, 'recall': 0.9677, 'fscore': 0.9682, 'acc': 0.9683}, '财经商业': {'precision': 0.9506, 'recall': 0.9606, 'fscore': 0.9554, 'acc': 0.9615}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9881332628239027, 'metric': 0.9512131917414115, 'recall': 0.9511898466419884, 'precision': 0.9512566641279512, 'acc': 0.9512195121951219, 'real': {'precision': 0.9537953795379538, 'recall': 0.9475409836065574, 'F1': 0.9506578947368421}, 'fake': {'precision': 0.9487179487179487, 'recall': 0.9548387096774194, 'F1': 0.9517684887459806}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:28<00:00,  2.74it/s]
Training Epoch 20; Loss 0.22798598799612615; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:04<00:00,  2.28it/s]
curent {'科技': {'precision': 0.9583, 'recall': 0.9167, 'fscore': 0.9328, 'acc': 0.9412}, '军事': {'precision': 0.8333, 'recall': 0.8667, 'fscore': 0.8231, 'acc': 0.8261}, '教育考试': {'precision': 0.8393, 'recall': 0.625, 'fscore': 0.6043, 'acc': 0.7097}, '灾难事故': {'precision': 0.7407, 'recall': 0.7742, 'fscore': 0.6792, 'acc': 0.6818}, '政治': {'precision': 0.7692, 'recall': 0.8, 'fscore': 0.725, 'acc': 0.7273}, '医药健康': {'precision': 0.7879, 'recall': 0.7182, 'fscore': 0.6971, 'acc': 0.7143}, '财经商业': {'precision': 0.8913, 'recall': 0.6875, 'fscore': 0.7118, 'acc': 0.8077}, '文体娱乐': {'precision': 0.9157, 'recall': 0.825, 'fscore': 0.8479, 'acc': 0.8716}, '社会生活': {'precision': 0.85, 'recall': 0.82, 'fscore': 0.802, 'acc': 0.8043}, 'auc': 0.946430460074035, 'metric': 0.7801142458030881, 'recall': 0.7885510312004231, 'precision': 0.8507379219911038, 'acc': 0.7902439024390244, 'real': {'precision': 0.9943820224719101, 'recall': 0.580327868852459, 'F1': 0.7329192546583851}, 'fake': {'precision': 0.7070938215102975, 'recall': 0.9967741935483871, 'F1': 0.8273092369477912}}
Max {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.9318, 'recall': 0.875, 'fscore': 0.892, 'acc': 0.9032}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9706, 'recall': 0.9677, 'fscore': 0.9682, 'acc': 0.9683}, '财经商业': {'precision': 0.9506, 'recall': 0.9606, 'fscore': 0.9554, 'acc': 0.9615}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9881332628239027, 'metric': 0.9512131917414115, 'recall': 0.9511898466419884, 'precision': 0.9512566641279512, 'acc': 0.9512195121951219, 'real': {'precision': 0.9537953795379538, 'recall': 0.9475409836065574, 'F1': 0.9506578947368421}, 'fake': {'precision': 0.9487179487179487, 'recall': 0.9548387096774194, 'F1': 0.9517684887459806}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:28<00:00,  2.75it/s]
Training Epoch 21; Loss 0.3150390055659529; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:04<00:00,  2.06it/s]
curent {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 0.9, 'recall': 0.9333, 'fscore': 0.9087, 'acc': 0.913}, '教育考试': {'precision': 0.913, 'recall': 0.8333, 'fscore': 0.8524, 'acc': 0.871}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.8621, 'recall': 0.9111, 'fscore': 0.8712, 'acc': 0.8788}, '医药健康': {'precision': 0.9047, 'recall': 0.9047, 'fscore': 0.9047, 'acc': 0.9048}, '财经商业': {'precision': 0.9188, 'recall': 0.8981, 'fscore': 0.9075, 'acc': 0.9231}, '文体娱乐': {'precision': 0.9657, 'recall': 0.9553, 'fscore': 0.9601, 'acc': 0.9633}, '社会生活': {'precision': 0.9072, 'recall': 0.9102, 'fscore': 0.9074, 'acc': 0.9076}, 'auc': 0.9799471179270227, 'metric': 0.9185180081826468, 'recall': 0.918376520359598, 'precision': 0.921479105845249, 'acc': 0.9186991869918699, 'real': {'precision': 0.9537366548042705, 'recall': 0.8786885245901639, 'F1': 0.9146757679180887}, 'fake': {'precision': 0.8892215568862275, 'recall': 0.9580645161290322, 'F1': 0.922360248447205}}
Max {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.9318, 'recall': 0.875, 'fscore': 0.892, 'acc': 0.9032}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9706, 'recall': 0.9677, 'fscore': 0.9682, 'acc': 0.9683}, '财经商业': {'precision': 0.9506, 'recall': 0.9606, 'fscore': 0.9554, 'acc': 0.9615}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9881332628239027, 'metric': 0.9512131917414115, 'recall': 0.9511898466419884, 'precision': 0.9512566641279512, 'acc': 0.9512195121951219, 'real': {'precision': 0.9537953795379538, 'recall': 0.9475409836065574, 'F1': 0.9506578947368421}, 'fake': {'precision': 0.9487179487179487, 'recall': 0.9548387096774194, 'F1': 0.9517684887459806}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:27<00:00,  2.77it/s]
Training Epoch 22; Loss 0.2829200691216951; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:04<00:00,  2.34it/s]
curent {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.9524, 'recall': 0.9167, 'fscore': 0.9295, 'acc': 0.9355}, '灾难事故': {'precision': 0.9697, 'recall': 0.9231, 'fscore': 0.9427, 'acc': 0.9545}, '政治': {'precision': 0.9302, 'recall': 0.9302, 'fscore': 0.9302, 'acc': 0.9394}, '医药健康': {'precision': 0.9444, 'recall': 0.9355, 'fscore': 0.9361, 'acc': 0.9365}, '财经商业': {'precision': 0.9038, 'recall': 0.9213, 'fscore': 0.9117, 'acc': 0.9231}, '文体娱乐': {'precision': 0.9375, 'recall': 0.946, 'fscore': 0.9414, 'acc': 0.945}, '社会生活': {'precision': 0.9115, 'recall': 0.9036, 'fscore': 0.9061, 'acc': 0.9076}, 'auc': 0.9769962982548915, 'metric': 0.9300628099173553, 'recall': 0.9302749867794817, 'precision': 0.930958686440678, 'acc': 0.9300813008130081, 'real': {'precision': 0.909375, 'recall': 0.9540983606557377, 'F1': 0.9312000000000001}, 'fake': {'precision': 0.9525423728813559, 'recall': 0.9064516129032258, 'F1': 0.9289256198347107}}
Max {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.9318, 'recall': 0.875, 'fscore': 0.892, 'acc': 0.9032}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9706, 'recall': 0.9677, 'fscore': 0.9682, 'acc': 0.9683}, '财经商业': {'precision': 0.9506, 'recall': 0.9606, 'fscore': 0.9554, 'acc': 0.9615}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9881332628239027, 'metric': 0.9512131917414115, 'recall': 0.9511898466419884, 'precision': 0.9512566641279512, 'acc': 0.9512195121951219, 'real': {'precision': 0.9537953795379538, 'recall': 0.9475409836065574, 'F1': 0.9506578947368421}, 'fake': {'precision': 0.9487179487179487, 'recall': 0.9548387096774194, 'F1': 0.9517684887459806}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:28<00:00,  2.67it/s]
Training Epoch 23; Loss 0.2606516579141865; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:04<00:00,  2.23it/s]
curent {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.9318, 'recall': 0.875, 'fscore': 0.892, 'acc': 0.9032}, '灾难事故': {'precision': 0.9643, 'recall': 0.9839, 'fscore': 0.9733, 'acc': 0.9773}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9386, 'recall': 0.936, 'fscore': 0.9364, 'acc': 0.9365}, '财经商业': {'precision': 0.9292, 'recall': 0.919, 'fscore': 0.9239, 'acc': 0.9359}, '文体娱乐': {'precision': 0.9657, 'recall': 0.9553, 'fscore': 0.9601, 'acc': 0.9633}, '社会生活': {'precision': 0.9292, 'recall': 0.9283, 'fscore': 0.9287, 'acc': 0.9293}, 'auc': 0.9851718667371762, 'metric': 0.947956334094948, 'recall': 0.9479111581173982, 'precision': 0.9480817656643461, 'acc': 0.9479674796747968, 'real': {'precision': 0.9534883720930233, 'recall': 0.940983606557377, 'F1': 0.9471947194719472}, 'fake': {'precision': 0.9426751592356688, 'recall': 0.9548387096774194, 'F1': 0.9487179487179487}}
Max {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.9318, 'recall': 0.875, 'fscore': 0.892, 'acc': 0.9032}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9706, 'recall': 0.9677, 'fscore': 0.9682, 'acc': 0.9683}, '财经商业': {'precision': 0.9506, 'recall': 0.9606, 'fscore': 0.9554, 'acc': 0.9615}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9881332628239027, 'metric': 0.9512131917414115, 'recall': 0.9511898466419884, 'precision': 0.9512566641279512, 'acc': 0.9512195121951219, 'real': {'precision': 0.9537953795379538, 'recall': 0.9475409836065574, 'F1': 0.9506578947368421}, 'fake': {'precision': 0.9487179487179487, 'recall': 0.9548387096774194, 'F1': 0.9517684887459806}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:28<00:00,  2.74it/s]
Training Epoch 24; Loss 0.24856462745697472; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:04<00:00,  2.23it/s]
curent {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.932, 'recall': 0.932, 'fscore': 0.932, 'acc': 0.9355}, '灾难事故': {'precision': 0.9697, 'recall': 0.9231, 'fscore': 0.9427, 'acc': 0.9545}, '政治': {'precision': 0.9418, 'recall': 0.9175, 'fscore': 0.9283, 'acc': 0.9394}, '医药健康': {'precision': 0.9211, 'recall': 0.9032, 'fscore': 0.9036, 'acc': 0.9048}, '财经商业': {'precision': 0.8863, 'recall': 0.9236, 'fscore': 0.9, 'acc': 0.9103}, '文体娱乐': {'precision': 0.9355, 'recall': 0.9513, 'fscore': 0.9419, 'acc': 0.945}, '社会生活': {'precision': 0.9116, 'recall': 0.8888, 'fscore': 0.8937, 'acc': 0.8967}, 'auc': 0.9841671073506082, 'metric': 0.923394951301928, 'recall': 0.9240349021681651, 'precision': 0.9287967914438502, 'acc': 0.9235772357723577, 'real': {'precision': 0.8794117647058823, 'recall': 0.980327868852459, 'F1': 0.9271317829457365}, 'fake': {'precision': 0.9781818181818182, 'recall': 0.867741935483871, 'F1': 0.9196581196581197}}
Max {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.9318, 'recall': 0.875, 'fscore': 0.892, 'acc': 0.9032}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9706, 'recall': 0.9677, 'fscore': 0.9682, 'acc': 0.9683}, '财经商业': {'precision': 0.9506, 'recall': 0.9606, 'fscore': 0.9554, 'acc': 0.9615}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9881332628239027, 'metric': 0.9512131917414115, 'recall': 0.9511898466419884, 'precision': 0.9512566641279512, 'acc': 0.9512195121951219, 'real': {'precision': 0.9537953795379538, 'recall': 0.9475409836065574, 'F1': 0.9506578947368421}, 'fake': {'precision': 0.9487179487179487, 'recall': 0.9548387096774194, 'F1': 0.9517684887459806}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:28<00:00,  2.71it/s]
Training Epoch 25; Loss 0.23056883993860963; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:04<00:00,  2.13it/s]
curent {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.9045, 'recall': 0.8904, 'fscore': 0.8963, 'acc': 0.9032}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9324, 'recall': 0.9194, 'fscore': 0.9199, 'acc': 0.9206}, '财经商业': {'precision': 0.9292, 'recall': 0.919, 'fscore': 0.9239, 'acc': 0.9359}, '文体娱乐': {'precision': 0.9729, 'recall': 0.9678, 'fscore': 0.9702, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9839873083024854, 'metric': 0.9447153009856593, 'recall': 0.9447646747752512, 'precision': 0.944745859508852, 'acc': 0.9447154471544715, 'real': {'precision': 0.9385113268608414, 'recall': 0.9508196721311475, 'F1': 0.9446254071661236}, 'fake': {'precision': 0.9509803921568627, 'recall': 0.9387096774193548, 'F1': 0.9448051948051949}}
Max {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.9318, 'recall': 0.875, 'fscore': 0.892, 'acc': 0.9032}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9706, 'recall': 0.9677, 'fscore': 0.9682, 'acc': 0.9683}, '财经商业': {'precision': 0.9506, 'recall': 0.9606, 'fscore': 0.9554, 'acc': 0.9615}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9881332628239027, 'metric': 0.9512131917414115, 'recall': 0.9511898466419884, 'precision': 0.9512566641279512, 'acc': 0.9512195121951219, 'real': {'precision': 0.9537953795379538, 'recall': 0.9475409836065574, 'F1': 0.9506578947368421}, 'fake': {'precision': 0.9487179487179487, 'recall': 0.9548387096774194, 'F1': 0.9517684887459806}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:28<00:00,  2.72it/s]
Training Epoch 26; Loss 0.22850362279198386; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:04<00:00,  2.24it/s]
curent {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.9615, 'recall': 0.9737, 'fscore': 0.9665, 'acc': 0.9677}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9651, 'recall': 0.9651, 'fscore': 0.9651, 'acc': 0.9697}, '医药健康': {'precision': 0.9211, 'recall': 0.9032, 'fscore': 0.9036, 'acc': 0.9048}, '财经商业': {'precision': 0.9, 'recall': 0.9444, 'fscore': 0.915, 'acc': 0.9231}, '文体娱乐': {'precision': 0.9605, 'recall': 0.9605, 'fscore': 0.9605, 'acc': 0.9633}, '社会生活': {'precision': 0.9338, 'recall': 0.9255, 'fscore': 0.9282, 'acc': 0.9293}, 'auc': 0.9854574299312532, 'metric': 0.9430508851254997, 'recall': 0.9433632998413537, 'precision': 0.9449444880803277, 'acc': 0.943089430894309, 'real': {'precision': 0.9141104294478528, 'recall': 0.9770491803278688, 'F1': 0.9445324881141046}, 'fake': {'precision': 0.9757785467128027, 'recall': 0.9096774193548387, 'F1': 0.941569282136895}}
Max {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.9318, 'recall': 0.875, 'fscore': 0.892, 'acc': 0.9032}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9706, 'recall': 0.9677, 'fscore': 0.9682, 'acc': 0.9683}, '财经商业': {'precision': 0.9506, 'recall': 0.9606, 'fscore': 0.9554, 'acc': 0.9615}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9881332628239027, 'metric': 0.9512131917414115, 'recall': 0.9511898466419884, 'precision': 0.9512566641279512, 'acc': 0.9512195121951219, 'real': {'precision': 0.9537953795379538, 'recall': 0.9475409836065574, 'F1': 0.9506578947368421}, 'fake': {'precision': 0.9487179487179487, 'recall': 0.9548387096774194, 'F1': 0.9517684887459806}}
  0%|                                                                                                                                                  | 0/77 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/functional.py:2943: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:28<00:00,  2.72it/s]
Training Epoch 27; Loss 0.22967084119846295; 
----- self.save_param_dir ./param_model/dammfnd
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:04<00:00,  2.22it/s]
curent {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 1.0, 'recall': 1.0, 'fscore': 1.0, 'acc': 1.0}, '教育考试': {'precision': 0.8786, 'recall': 0.8487, 'fscore': 0.8591, 'acc': 0.871}, '灾难事故': {'precision': 0.9643, 'recall': 0.9839, 'fscore': 0.9733, 'acc': 0.9773}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9324, 'recall': 0.9194, 'fscore': 0.9199, 'acc': 0.9206}, '财经商业': {'precision': 0.9286, 'recall': 0.963, 'fscore': 0.9423, 'acc': 0.9487}, '文体娱乐': {'precision': 0.9487, 'recall': 0.9533, 'fscore': 0.9509, 'acc': 0.9541}, '社会生活': {'precision': 0.9338, 'recall': 0.9255, 'fscore': 0.9282, 'acc': 0.9293}, 'auc': 0.9855949233209942, 'metric': 0.9447036049758821, 'recall': 0.9448968799576943, 'precision': 0.945490553249174, 'acc': 0.9447154471544715, 'real': {'precision': 0.9247648902821317, 'recall': 0.9672131147540983, 'F1': 0.9455128205128205}, 'fake': {'precision': 0.9662162162162162, 'recall': 0.9225806451612903, 'F1': 0.9438943894389439}}
Max {'科技': {'precision': 0.9286, 'recall': 0.9545, 'fscore': 0.9377, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.9318, 'recall': 0.875, 'fscore': 0.892, 'acc': 0.9032}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.9706, 'recall': 0.9677, 'fscore': 0.9682, 'acc': 0.9683}, '财经商业': {'precision': 0.9506, 'recall': 0.9606, 'fscore': 0.9554, 'acc': 0.9615}, '文体娱乐': {'precision': 0.9792, 'recall': 0.9625, 'fscore': 0.9699, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9881332628239027, 'metric': 0.9512131917414115, 'recall': 0.9511898466419884, 'precision': 0.9512566641279512, 'acc': 0.9512195121951219, 'real': {'precision': 0.9537953795379538, 'recall': 0.9475409836065574, 'F1': 0.9506578947368421}, 'fake': {'precision': 0.9487179487179487, 'recall': 0.9548387096774194, 'F1': 0.9517684887459806}}
开始进行最后的测试
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:04<00:00,  2.18it/s]
final:  {'科技': {'precision': 0.9583, 'recall': 0.9167, 'fscore': 0.9328, 'acc': 0.9412}, '军事': {'precision': 0.9444, 'recall': 0.9667, 'fscore': 0.9533, 'acc': 0.9565}, '教育考试': {'precision': 0.975, 'recall': 0.9583, 'fscore': 0.9654, 'acc': 0.9677}, '灾难事故': {'precision': 0.9454, 'recall': 0.9454, 'fscore': 0.9454, 'acc': 0.9545}, '政治': {'precision': 0.9773, 'recall': 0.9889, 'fscore': 0.9828, 'acc': 0.9848}, '医药健康': {'precision': 0.925, 'recall': 0.9199, 'fscore': 0.9203, 'acc': 0.9206}, '财经商业': {'precision': 0.9506, 'recall': 0.9606, 'fscore': 0.9554, 'acc': 0.9615}, '文体娱乐': {'precision': 0.9729, 'recall': 0.9678, 'fscore': 0.9702, 'acc': 0.9725}, '社会生活': {'precision': 0.9242, 'recall': 0.9224, 'fscore': 0.9232, 'acc': 0.9239}, 'auc': 0.9858064516129033, 'metric': 0.9495913635053634, 'recall': 0.9496033844526706, 'precision': 0.9495843644901326, 'acc': 0.9495934959349593, 'real': {'precision': 0.9477124183006536, 'recall': 0.9508196721311475, 'F1': 0.9492635024549918}, 'fake': {'precision': 0.9514563106796117, 'recall': 0.9483870967741935, 'F1': 0.9499192245557351}}
